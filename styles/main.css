/* ===== 見た目の基準値（流体レイアウト） ===== */
:root{
  /* 画面幅に応じて自動で縮む／広がる */
  --space:   clamp(12px, 3.5vw, 20px);  /* 余白 */
  --gap:     clamp(8px,  2.6vw, 16px);  /* すき間 */
  --card-w:  clamp(68px, 21vw, 110px);  /* カード幅 */
  --card-h:  clamp(96px, 29vw, 150px);  /* カード高 */
  --btn-h:   44px;                      /* ボタン高 */
  --font-base: 16px;                    /* ベース文字 */
  --digit-scale: .68;                   /* 7セグの相対サイズ（下でメディア別に微調整） */
}
/* タブレット以上は少しゆったり */
@media (min-width: 720px){
  :root{
    --space: 20px;
    --gap: 20px;
    --card-w: 128px;
    --card-h: 180px;
    --btn-h: 48px;
    --font-base: 18px;
    --digit-scale: .70;
  }
}

@font-face{
  font-family: 'DSEG7Modern';
  src: url('../assets/fonts/DSEG7Modern-Bold.woff2') format('woff2');
  font-style: normal;
  font-weight: 700;
  font-display: swap;
}

*{box-sizing:border-box}
html,body{
  height:100%;
  /* 万一の横はみ出しを抑止（保険） */
  overflow-x: hidden;
}
body{
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif;
  font-size: var(--font-base);
  background:#f6f7fb;
  margin:0;
  color:#222;
}

header{
  position: sticky;
  top:0;
  background:#fff;
  border-bottom:1px solid #e5e7eb;
  padding: calc(var(--space) * .75) var(--space);
  text-align:center;
  z-index:10;
}
header h1{margin:0;font-size: clamp(20px, 3.2vw, 32px); letter-spacing:.5px;}
header .highlight{ color:#ef4444; }

.wrapper{
  max-width: 880px;
  margin: 0 auto;
  padding: var(--space);
  display: grid;
  gap: var(--gap);
  width: 100%;
}

/* 共通カード風コンテナ */
.card{
  background:#fff;
  border:1px solid #e5e7eb;
  border-radius:12px;
  padding: var(--space);
  box-shadow:0 1px 2px rgba(0,0,0,.04);
}
.hidden{ display:none !important; }

.box{ margin-bottom: var(--space); }
input,select,button{
  font-size: 1rem;
  height: var(--btn-h);
  padding: 0 12px;
  border-radius:10px;
  border:1px solid #d1d5db;
  background:#fff;
}
button{
  background:#111827;
  color:#fff;
  border:none;
  cursor:pointer;
}
button:disabled{ opacity:.5; cursor:not-allowed; }
.btn{ height: var(--btn-h); padding:0 16px; }

#setupSection.card,
#gameSection.card { display:block; }

/* ── スコア行 ───────────────────────────── */
.score-info{
  display:flex;
  align-items:center;
  gap: var(--gap);
  flex-wrap: wrap;
  margin-bottom: var(--space);
}
.score-info .highlight-target{ color:#ef4444; font-weight:700; }
.score-info .score-value{ font-weight:700; }

/* ★ 8人対応：スコアをグリッドで整列 */
.player-scores{
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 8px;
  margin-bottom: var(--space);
}
.player-scores > div{
  background:#f9fafb;
  border:1px solid #e5e7eb;
  border-radius:10px;
  padding: 6px 10px;
}

/* 検索行 */
.search-area{
  display:flex;
  gap: var(--gap);
  align-items:center;
  flex-wrap: nowrap;
}
.search-area input{
  flex: 1 1 auto;
  min-width: 0;              /* ← はみ出し防止（180px から変更） */
}
.search-area button{
  flex: 0 0 auto;
  padding:0 14px;
}

/* 桁カード群 */
.digits{
  display:flex;
  justify-content:center;
  gap: var(--gap);
  padding-top: var(--space);
}
.digit-box{
  width: var(--card-w);
  height: var(--card-h);
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:14px;
  border:2px solid #111827;
  background:#fff;
  box-shadow: 0 6px 14px rgba(0,0,0,.06);
  user-select:none;
}

/* 覆いレイヤーのアニメーション */
.digit-box{ position: relative; overflow: hidden; }
.digit-box .digit-value{
  position: relative; z-index: 1;
  font-family: 'DSEG7Modern', system-ui, sans-serif;
  line-height: .86;
  letter-spacing: .01em;
  transform: translateY(1px);
}
.digit-box .digit-cover{
  position: absolute; inset: 0;
  background: #0b0f19;
  border-radius: inherit;
  transform: translateY(100%);      /* 初期は非表示（下に退避） */
  transition: transform 700ms cubic-bezier(.22,.61,.36,1);
  pointer-events: none;
  z-index: 2;
  will-change: transform;
}
@media (prefers-reduced-motion: reduce){
  .digit-box .digit-cover{ transition: none; }
}
.digit-box.covered .digit-cover{ transform: translateY(0%); }    /* 黒塗りON */
.digit-box.opened  .digit-cover{ transform: translateY(100%); }  /* 下へスライドして開く */

/* 数字サイズをカード高に比例させる（安定） */
.digits .digit-box{ font-size: calc(var(--card-h) * var(--digit-scale)); }

/* 検索直後だけアニメ無効化するためのクラス */
.digit-box.no-anim .digit-cover{ transition: none !important; }

/* ボタン行 */
.digit-buttons{
  display:flex;
  justify-content:center;
  gap: calc(var(--gap) * 1.25);
  margin-top: calc(var(--space) * .5);
  flex-wrap: wrap;
}
.digit-buttons button{
  width: 64px; height: 64px;
  border-radius: 50%;
  font-size: 0.95rem;
  background:#374151;
}
.digit-buttons button:disabled{ background:#9ca3af; }

/* 操作ボタン行 */
.controls{
  display:flex;
  gap: var(--gap);
  justify-content: center;
  flex-wrap: wrap;
}
.controls button{
  min-width: clamp(120px, 32vw, 180px);  /* ← 画面に応じて縮む */
  height: var(--btn-h);
  border-radius: 10px;
  background:#111827;
}
.controls #restartButton{ background:#065f46; }   /* 緑 */
.controls #showResultsButton{ background:#1f2937; } /* 濃グレー */
.controls #nextPlayerButton{ background:#4b5563; }   /* グレー */

/* リザルト／使用ワード */
.result-message{
  text-align:center;
  font-weight:700;
  padding: 10px 12px;
}
.result-message.game-over{ color:#1d4ed8; }
.result-message.game-over.over-score{ color:#dc2626; }

.result-list, .used-words{
  margin-top: var(--space);
  background:#fff;
  border:1px solid #e5e7eb;
  border-radius:12px;
  padding: var(--space);
}
.result-list ul, .used-words ul{ margin:0; padding-left: 20px; }

/* セクションをカード化（既存の構造を壊さずカード化） */
#setupSection,
#gameSection{
  background:#fff;
  border:1px solid #e5e7eb;
  border-radius:12px;
  padding: calc(var(--space) * 1.25);
  box-shadow:0 1px 2px rgba(0,0,0,.04);
}

/* スマホ最適化の細かい補正 */
@media (max-width: 480px){
  .controls button{ min-width: 100%; }
  .digit-buttons{ gap: var(--gap); }
  .search-area{ gap: 10px; }
  :root{ --digit-scale: .64; }   /* 7セグを少し抑える */
}

/* フィルタチップ */
.filter-chips{
  display:flex; gap:8px; align-items:center;
  margin-top:10px; flex-wrap:wrap;
}
.chip{
  display:inline-flex; align-items:center; gap:6px;
  padding:6px 10px; border-radius:999px;
  font-size:.9rem; background:#eef2ff; color:#1e40af;
  border:1px solid #c7d2fe;
}
.chip.and{ background:#ecfeff; color:#155e75; border-color:#a5f3fc; }
.chip.lock::before{ content:'🔒'; }
.chip.and::before{ content:'AND'; font-weight:700; font-size:.8rem; }
